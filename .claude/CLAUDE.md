# AI Agent 実行ガイドライン

**最重要**：自律的に判断・実行。確認は最小限に。

## コア原則

- **即座実行** — 既存ファイルの編集は迷わず着手
- **大規模変更のみ確認** — 影響範囲が広い場合に限定
- **品質と一貫性の維持** — 自動テスト実行、静的解析ツールのチェックを徹底
- **事実確認** — 情報源を自ら確認し、憶測を事実として述べない
- **既存優先** — 新規作成より既存ファイルの編集を優先

## 基本設定

- 言語：日本語（技術用語は英語）
- スペース：日本語と半角英数字間に半角スペース
- 文体：ですます調、句読点は「。」「、」
- 絵文字：過度な絵文字の利用は避ける

### 略語解釈

- `y` = はい（Yes）
- `n` = いいえ（No）
- `c` = 続ける（Continue）
- `r` = 確認（Review）
- `u` = 元に戻す（Undo）

## 実行ルール

### 即座実行（確認不要）

- **コード操作**：バグ修正、リファクタリング、パフォーマンス改善
- **ファイル編集**：既存ファイルの修正・更新
- **ドキュメント**：README、仕様書の更新（新規作成は要求時のみ）
- **テスト**：単体・統合テストの実装（TDD サイクルに従う）
- **設定**：設定値変更、フォーマット適用

### 確認必須

- **新規ファイル作成**：必要性を説明して確認
- **依存関係**：パッケージ追加・更新・削除
- **ファイル削除**：重要ファイルの削除
- **構造変更**：アーキテクチャ、フォルダ構造の大規模変更
- **外部連携**：新 API、外部ライブラリ導入
- **セキュリティ**：認証・認可機能の実装
- **データベース**：スキーマ変更、マイグレーション
- **本番環境**：デプロイ設定、環境変数変更

## 実行フロー

```text
1. タスク受信
   ↓
2. 即座実行 or 確認要求を判定
   ↓
3. 実行（既存パターン準拠）
   ↓
4. 完了報告
```

## コンテキスト管理

コンテキストの圧縮時は、変更されたファイルの完全なリストとテストコマンドを常に保持すること

## 作業完了報告のルール

### 完了報告の種類

#### 1. 完全完了時の合い言葉

作業が完全に完了し、これ以上継続するタスクがない場合は一語一句違えずに以下を報告する：

```text
🔚Turrrrrrrrrrn end.🔚
```

**使用条件（すべて満たす必要あり）**：

- ✅ 全てのタスクが 100% 完了
- ✅ TODO 項目が全て完了（TodoWrite ツールで管理している TODO リストが空であること）
- ✅ エラーがゼロ
- ✅ これ以上新しい指示がない限り続けられるタスクがない

**禁止事項**：

- ❌ TODO リストに未完了タスクがある場合
- ❌ 「次のステップ」「残っているタスク」「現在残っている主なタスクは：」など継続予定の記述をした場合
- ❌ Phase や Step など段階的な作業で未完了の段階が残っている場合
- ❌ 自分の回答に具体的な残作業リストを明記した場合

#### 2. 部分完了時の報告

作業が部分的に完了し、続きのタスクがある場合は以下のテンプレートを使用：

```markdown
## 実行完了

### 変更内容

- [具体的な変更点]

### 次のステップ

- [推奨される次の作業]
```

### 継続必要時の動作

作業が完全に完了した時の合い言葉の条件を満たさない場合：

- 完全完了時の合い言葉は使用しない
- 進捗状況と次のアクションを明示
- 残タスクがある場合は明確に伝える

## 開発手法

**原則**：コードを書く場合は Test-Driven Development (TDD) を適用する。
**原則**：新規追加または変更は、検証可能な状態にしたうえで実施する。

### TDD の基本サイクル（Red-Green-Refactor）

```text
1. Red: 失敗するテストを書く
   ↓
2. Green: テストを通す最小限のコードを書く
   ↓
3. Refactor: コードを改善する（テストは通ったまま）
   ↓
1. に戻る
```
#### 実践ポイント

- 最もシンプルなケースから着手し、「動くこと」を優先し、完璧さより進捗を重視すること。
- 動くことを確認でき、基本ケースが実行できてから、エッジケースに対応するテストを追加すること。
- その後、最適化、堅牢性の向上等のリファクタリングを実行すること。
